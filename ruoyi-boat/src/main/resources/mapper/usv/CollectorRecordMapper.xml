<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.apollo.usv.mapper.CollectorRecordMapper">
    
    <resultMap type="CollectorRecord" id="CollectorRecordResult">
        <result property="id"    column="collector_record_id"    />
        <result property="sn"    column="collector_sn"    />
        <result property="dissolvedOxygen"    column="dissolved_oxygen"    />
        <result property="conductivity"    column="conductivity"    />
        <result property="turbidity"    column="turbidity"    />
        <result property="ph"    column="ph"    />
        <result property="cod"    column="cod"    />
        <result property="ammoniaNitrogen"    column="ammonia_nitrogen"    />
        <result property="longitude"    column="longitude"    />
        <result property="latitude"    column="latitude"    />
        <result property="time"    column="time"    />
    </resultMap>

    <sql id="selectCollectorRecordVo">
        select collector_record_id, collector_sn, dissolved_oxygen, conductivity, turbidity, ph, cod, ammonia_nitrogen, longitude, latitude, time from usv_collector_record
    </sql>

    <select id="selectCollectorRecordList" parameterType="CollectorRecord" resultMap="CollectorRecordResult">
        <include refid="selectCollectorRecordVo"/>
        <where>  
            <if test="sn != null  and sn != ''"> and collector_sn = #{sn}</if>
            <if test="params.beginTime != null and params.beginTime != '' and params.endTime != null and params.endTime != ''"> and time between #{params.beginTime} and #{params.endTime}</if>
        </where>
    </select>
    
    <select id="selectCollectorRecordById" parameterType="Long" resultMap="CollectorRecordResult">
        <include refid="selectCollectorRecordVo"/>
        where collector_record_id = #{id}
    </select>
        
    <insert id="insertCollectorRecord" parameterType="CollectorRecord" useGeneratedKeys="true" keyProperty="id">
        insert into usv_collector_record
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="sn != null and sn != ''">collector_sn,</if>
            <if test="dissolvedOxygen != null">dissolved_oxygen,</if>
            <if test="conductivity != null">conductivity,</if>
            <if test="turbidity != null">turbidity,</if>
            <if test="ph != null">ph,</if>
            <if test="cod != null">cod,</if>
            <if test="ammoniaNitrogen != null">ammonia_nitrogen,</if>
            <if test="longitude != null and longitude != ''">longitude,</if>
            <if test="latitude != null and latitude != ''">latitude,</if>
            <if test="time != null">time,</if>
         </trim>
        <trim prefix="values (" suffix=")" suffixOverrides=",">
            <if test="sn != null and sn != ''">#{sn},</if>
            <if test="dissolvedOxygen != null">#{dissolvedOxygen},</if>
            <if test="conductivity != null">#{conductivity},</if>
            <if test="turbidity != null">#{turbidity},</if>
            <if test="ph != null">#{ph},</if>
            <if test="cod != null">#{cod},</if>
            <if test="ammoniaNitrogen != null">#{ammoniaNitrogen},</if>
            <if test="longitude != null and longitude != ''">#{longitude},</if>
            <if test="latitude != null and latitude != ''">#{latitude},</if>
            <if test="time != null">#{time},</if>
         </trim>
    </insert>

    <update id="updateCollectorRecord" parameterType="CollectorRecord">
        update usv_collector_record
        <trim prefix="SET" suffixOverrides=",">
            <if test="sn != null and sn != ''">collector_sn = #{sn},</if>
            <if test="dissolvedOxygen != null">dissolved_oxygen = #{dissolvedOxygen},</if>
            <if test="conductivity != null">conductivity = #{conductivity},</if>
            <if test="turbidity != null">turbidity = #{turbidity},</if>
            <if test="ph != null">ph = #{ph},</if>
            <if test="cod != null">cod = #{cod},</if>
            <if test="ammoniaNitrogen != null">ammonia_nitrogen = #{ammoniaNitrogen},</if>
            <if test="longitude != null and longitude != ''">longitude = #{longitude},</if>
            <if test="latitude != null and latitude != ''">latitude = #{latitude},</if>
            <if test="time != null">time = #{time},</if>
        </trim>
        where collector_record_id = #{id}
    </update>

    <delete id="deleteCollectorRecordById" parameterType="Long">
        delete from usv_collector_record where collector_record_id = #{id}
    </delete>

    <delete id="deleteCollectorRecordByIds" parameterType="String">
        delete from usv_collector_record where collector_record_id in 
        <foreach item="id" collection="array" open="(" separator="," close=")">
            #{id}
        </foreach>
    </delete>
</mapper>