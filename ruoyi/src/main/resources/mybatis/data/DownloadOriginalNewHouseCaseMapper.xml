<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ruoyi.project.data.cases.mapper.sync.DownloadOriginalNewHouseCaseMapper">
    <resultMap id="ResultMapping" type="com.ruoyi.project.data.cases.domain.OriginalNewHouseCase">
        <result property="caseCounty" column="区域"/>
        <result property="caseBlock" column="板块"/>
        <result property="caseLoop" column="环线"/>
        <result property="caseCommunityName" column="小区名称"/>
        <result property="caseAddress" column="房屋地址"/>
        <result property="caseArea" column="面积"/>
        <result property="caseTotalPrice" column="总价"/>
        <result property="caseUnitPrice" column="单价"/>
        <result property="caseHouseType" column="房屋类型"/>
        <result property="caseSigningDate" column="签约日期" jdbcType="DATE"/>
        <result property="caseFloor" column="楼层"/>
        <result property="caseHouseProperty" column="房屋性质"/>
        <result property="caseApartmentLayout" column="户型"/>
        <result property="computeUnitPrice" column="计算单价"/>
        <result property="computeTotalPrice" column="计算总价"/>
        <result property="referenceUnitPrice" column="参考单价"/>
        <result property="referenceTotalPrice" column="参考总价"/>
        <result property="yearMonth" column="yearMonth"/>
    </resultMap>
    <select id="getFirst" resultMap="ResultMapping">
        SELECT 区域
              ,板块
              ,环线
              ,小区名称
              ,房屋地址
              ,面积
              ,总价
              ,单价
              ,房屋类型
              ,签约日期
              ,楼层
              ,房屋性质
              ,户型
              ,计算单价
              ,计算总价
              ,参考单价
              ,参考总价
              ,${yearMonth} as yearMonth
       FROM dbo.一手房成交数据${yearMonth}
    </select>
    <select id="getSecond" resultMap="ResultMapping">
        <bind name="targetTableName" value="'dbo.一手房成交数据' + yearMonth+'_update'"/>
        SELECT 区域
              ,板块
              ,环线
              ,小区名称
              ,房屋地址
              ,面积
              ,总价
              ,单价
              ,房屋类型
              ,签约日期
              ,楼层
              ,房屋性质
              ,户型
              ,计算单价
              ,计算总价
              ,参考单价
              ,参考总价
              ,${yearMonth} as yearMonth
       FROM ${targetTableName}
    </select>
</mapper>