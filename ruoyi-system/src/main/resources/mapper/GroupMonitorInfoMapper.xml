<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ruoyi.system.mapper.GroupMonitorInfoMapper">


    <select id="getPlayOriginalGroupId" resultType="com.ruoyi.system.domain.GroupMonitorInfo">
        select tgmi.*
        from t_play_info tpi
                 join t_play_group_info tpgi on tpgi.play_id = tpi.id
                 join t_group_monitor_info tgmi on tpgi.tg_group_id = tgmi.group_id
                 join t_group_state tgs on tgs.group_id = tgmi.group_id
        where tpi.state in (1, 2)
          and tgmi.bot_check = 1
          and tpgi.is_delete = 0
          and tpgi.into_status = 2
          and tgmi.group_status = 0
          group by tgmi.group_id
    </select>

    <select id="getGroupPlayInfoVO" resultType="com.ruoyi.system.domain.vo.GroupPlayInfoVO">
        SELECT
            tpgi.play_id,
            tgmi.group_id,
            tgmi.original_group_id,
            tgi.group_serial_no,
            tgi.group_name
        FROM
            t_group_monitor_info tgmi
            INNER JOIN t_group_info tgi on tgmi.group_id = tgi.group_id
            INNER JOIN t_play_group_info tpgi ON tpgi.tg_group_id = tgmi.group_id
        WHERE
            1 = 1
          AND tgmi.original_group_id = #{originalGroupId}
	      AND tpgi.into_status = 2
        ORDER BY
            tpgi.create_time DESC
            LIMIT 1
    </select>

</mapper>
